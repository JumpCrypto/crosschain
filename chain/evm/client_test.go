package evm

import (
	"errors"
	"fmt"

	xc "github.com/jumpcrypto/crosschain"
	"github.com/jumpcrypto/crosschain/test"
)

func (s *CrosschainTestSuite) TestNewClient() {
	require := s.Require()
	client, err := NewClient(&xc.NativeAssetConfig{})
	require.NotNil(client)
	require.False(client.Legacy)
	require.Nil(err)
}

func (s *CrosschainTestSuite) TestNewLegacyClient() {
	require := s.Require()
	client, err := NewLegacyClient(&xc.NativeAssetConfig{})
	require.NotNil(client)
	require.True(client.Legacy)
	require.Nil(err)
}

func (s *CrosschainTestSuite) TestAccountBalance() {
	require := s.Require()

	vectors := []struct {
		resp interface{}
		val  string
		err  string
	}{
		{
			`"0x123"`,
			"291",
			"",
		},
		{
			`null`,
			"0",
			"cannot unmarshal non-string into Go value of type",
		},
		{
			`{}`,
			"0",
			"cannot unmarshal non-string into Go value of type",
		},
		{
			errors.New(`{"message": "custom RPC error", "code": 123}`),
			"",
			"custom RPC error",
		},
	}

	for _, v := range vectors {
		server, close := test.MockJSONRPC(&s.Suite, v.resp)
		defer close()

		client, _ := NewClient(&xc.NativeAssetConfig{URL: server.URL, Type: xc.AssetTypeNative})
		from := xc.Address("0x0eC9f48533bb2A03F53F341EF5cc1B057892B10B")
		balance, err := client.FetchBalance(s.Ctx, from)

		if v.err != "" {
			require.Equal("0", balance.String())
			require.ErrorContains(err, v.err)
		} else {
			require.Nil(err)
			require.NotNil(balance)
			require.Equal(v.val, balance.String())
		}
	}
}

// func (s *CrosschainTestSuite) TestFetchTxInput() {
// 	require := s.Require()
// 	client, _ := NewClient(xc.AssetConfig{})
// 	from := xc.Address("from")
// 	input, err := client.FetchTxInput(s.Ctx, from, "")
// 	require.NotNil(input)
// 	require.EqualError(err, "not implemented")
// }

func (s *CrosschainTestSuite) TestSubmitTx() {
	require := s.Require()

	vectors := []struct {
		name string
		resp interface{}
		val  *TxInput
		err  string
	}{
		// Send ether normal tx
		{
			"fetchTxInput",
			[]string{
				// eth_getTransactionCount
				`"0x6"`,
				// eth_gasPrice
				`"0x246139ca800"`,
			},
			&TxInput{
				TxInputEnvelope: *xc.NewTxInputEnvelope(xc.DriverEVM),
				Nonce:           6,
				GasLimit:        0,
				GasTipCap:       xc.NewAmountBlockchainFromUint64(3000000000),
				GasFeeCap:       xc.NewAmountBlockchainFromUint64(46000000000),
				GasPrice:        xc.NewAmountBlockchainFromUint64(46000000000),
			},
			"",
		},
	}
	for _, v := range vectors {
		fmt.Println("testing ", v.name)
		server, close := test.MockJSONRPC(&s.Suite, v.resp)
		defer close()
		client, _ := NewClient(&xc.NativeAssetConfig{NativeAsset: xc.ETH, URL: server.URL})
		input, err := client.FetchTxInput(s.Ctx, xc.Address(""), xc.Address(""))
		require.NoError(err)
		if v.err != "" {
			require.Equal(TxInput{}, input)
			require.ErrorContains(err, v.err)
		} else {
			require.Nil(err)
			require.NotNil(input)
			require.Equal(v.val, input)
		}
	}
}

func (s *CrosschainTestSuite) TestFetchTxInfo() {
	require := s.Require()

	vectors := []struct {
		name   string
		txHash string
		resp   interface{}
		val    xc.TxInfo
		err    string
	}{
		// Send ether normal tx
		{
			"normal_ether_deposit",
			"0xbca068cf854af49fc6b28ff5405068d51d3cefb870e624d22d046005a22349d0",
			[]string{
				// eth_getTransactionByHash
				`{"blockHash":"0xd090a9e97e00aa135710a92c827def07e4c8ff2269fd69411c48402e0a6a2a89","blockNumber":"0x8914cc","from":"0x17519be39a6b67a19468dfbdc1d795c38232c274","gas":"0x5208","gasPrice":"0x3e22ba6cde5","hash":"0xbca068cf854af49fc6b28ff5405068d51d3cefb870e624d22d046005a22349d0","input":"0x","nonce":"0x1","to":"0xa0a5c02f0371ccc142ad5ad170c291c86c3e6379","transactionIndex":"0x0","value":"0x49da27372c2bdee6","type":"0x0","chainId":"0x5","v":"0x2d","r":"0xbc8fc6daecc690912d8e6b7ab4e47188b562a2d5094a04b23b116753a077099a","s":"0x5ae2837a3b5b6cdf88c0cd367a6faaa52f38d7f71bc4f871dba389ad18237015"}`,
				// eth_getTransactionReceipt
				`{"blockHash":"0xd090a9e97e00aa135710a92c827def07e4c8ff2269fd69411c48402e0a6a2a89","blockNumber":"0x8914cc","contractAddress":null,"cumulativeGasUsed":"0x5208","effectiveGasPrice":"0x3e22ba6cde5","from":"0x17519be39a6b67a19468dfbdc1d795c38232c274","gasUsed":"0x5208","logs":[],"logsBloom":"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","status":"0x1","to":"0xa0a5c02f0371ccc142ad5ad170c291c86c3e6379","transactionHash":"0xbca068cf854af49fc6b28ff5405068d51d3cefb870e624d22d046005a22349d0","transactionIndex":"0x0","type":"0x0"}`,
				// eth_getBlockByNumber
				`{"baseFeePerGas":"0xb","difficulty":"0x0","extraData":"0xd883010b04846765746888676f312e32302e32856c696e7578","gasLimit":"0x1c9c380","gasUsed":"0x27e6d9","hash":"0xd090a9e97e00aa135710a92c827def07e4c8ff2269fd69411c48402e0a6a2a89","logsBloom":"0x44000000002040440011000200010000100008000040008800000000800000000122000108000000001400080004008404001004400002200008140400200000000240019800000040000008000210000005000000008000004001000008002000002200020200000000008100100820200004400420458808c242140080102093020050080010200000800000000000000000000010028004030001104200000600000000100200000201000000020000000200a04c0340008000060020000280300003000000080002204000020000000090000080028020010040080020000010000004200004201001200040000800400008029002000200401800000002","miner":"0x0000000000000000000000000000000000000000","mixHash":"0xb460ee4e35822216ac484dfcb7641fef4b9afed393279b13ec4faeade6bbce99","nonce":"0x0000000000000000","number":"0x8914cc","parentHash":"0xc6c2e8a0f3395d584ad2bcff333736a9dd7245d9a223a4e4bc252e32b442c610","receiptsRoot":"0xcc3d1989ea341f5f696ad76b34b60971687ab688f573eecd5e50302d140021e5","sha3Uncles":"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347","size":"0x27da","stateRoot":"0x6401e2e073ac8a27bb99b42151333f172c8aef69c54d33805e463c3deafde36b","timestamp":"0x645d6cb0","totalDifficulty":"0xa4a470","transactions":["0xbca068cf854af49fc6b28ff5405068d51d3cefb870e624d22d046005a22349d0","0xbce5302a41d8b84f7dfc9f987a47d9b6711d7f84e939e0acd0f0623d2db5275a","0xd2a1a4b08185e707a388a78af90c253fbbcc249b1b24594df42dcf270c90b94f","0xef4c32a8fe320b54017d462ea5759ef3fa3d8f170775d22639d01ee431104b53","0x3e9cdbc9782bb7042198096ea4fa6c2b07c0e54a0325ae9bf3443c0be57d5917","0x76461b1ad7b8b0b586b2e9a311cda9127385e0c43366350e3fa9e8b9af1cf8df","0xcd1c83f194e0fe6f7e3da8285e7da31bdd002d150af765370212997270271488","0x3331263d8b0e068fe7a89583deddcec20152375766a1a07010b11184932aaf79","0x998b5339862b5a9cd10936b5ea73236a04f148d10ffa5ecc5122128fc957ed02","0xfd212e955146ded9ea2416fd65eb7c23ace7d7175e00d97139a8c415c60575ef","0xb5bf8cec91d0ba6026a01b0b933d6f6912e79595e0d65a92c07b313ae7c6af63","0x554a1ddc07ed336b40b1c561f76ebd5bed6dc75cdd9562fab250a36372de61d3","0x35837da336ecb064bc9348d504a943b0b4d36b51dc1d44343ca1fd30964fb253","0x3a24aaafed98a979b03c3c8057ad7fb96209cadc2be89304a4671a817fd719fc","0x39e459b2504df5ac04a220aa33ffeb24257c01c5c006d244f3d1ae4df5e0bcb9","0xb8b01c71bcea7008b666c6146ca807fc3737d6dfa0de882e1bf041d8f9a5d582","0xde2fdbecf03afc07e202a37f92a439d58760ce091b008ae18f1edb2ea15d2073"],"transactionsRoot":"0x69f8755536692771ea8dcfc81dd31df84fe3829c59aa6ae8b46d5de3ebf944aa","uncles":[],"withdrawals":[{"index":"0x4fcf74","validatorIndex":"0x9d40","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1eeecf"},{"index":"0x4fcf75","validatorIndex":"0x9d41","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e3848"},{"index":"0x4fcf76","validatorIndex":"0x9d42","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e686f"},{"index":"0x4fcf77","validatorIndex":"0x9d43","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1d40a9"},{"index":"0x4fcf78","validatorIndex":"0x9d44","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1f459d"},{"index":"0x4fcf79","validatorIndex":"0x9d45","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e01e6"},{"index":"0x4fcf7a","validatorIndex":"0x9d46","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1ed357"},{"index":"0x4fcf7b","validatorIndex":"0x9d47","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e24b1"},{"index":"0x4fcf7c","validatorIndex":"0x9d48","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e17ee"},{"index":"0x4fcf7d","validatorIndex":"0x9d49","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e344f"},{"index":"0x4fcf7e","validatorIndex":"0x9d4a","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e0d01"},{"index":"0x4fcf7f","validatorIndex":"0x9d4b","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1dfe14"},{"index":"0x4fcf80","validatorIndex":"0x9d4c","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e47c6"},{"index":"0x4fcf81","validatorIndex":"0x9d4d","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e76dd"},{"index":"0x4fcf82","validatorIndex":"0x9d4e","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e0202"},{"index":"0x4fcf83","validatorIndex":"0x9d4f","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1d032a"}],"withdrawalsRoot":"0x401484fc49fe77cb4d010977c5d26f6621c9b586377a3572b9c542dc996267fb"}`,
				// eth_getBlockByNumber
				`{"baseFeePerGas":"0xc","difficulty":"0x0","extraData":"0x506f776572656420627920626c6f58726f757465","gasLimit":"0x1c9c380","gasUsed":"0x6370e2","hash":"0x6731d229b8ee277afb29ef9f0505aa628642842e6ba9ba484ec26f3d74cb5e14","logsBloom":"0x00200800024010000018000280010080000d0000014000080045001088000010012210010001220200000001010400840000100440020304040016048024004000060000047020804900000b00a002240008c2000500300180088000a08800200080310002000000000000a40010084080000804010000000124041488000000410222200000100a2440001080000402000044810004008800800145102200400200000010000010000000020010000000400200204c00400100014000a20002006040020180000885422001050240080048000000814010000122000aa2a10a28100229340042008400436020002800000111000a0040d00000400000000041","miner":"0x8dc847af872947ac18d5d63fa646eb65d4d99560","mixHash":"0x0fcc735f658e8a7a25ae8d8230a683f9408a1d9bc0e9b3526b0c5c3807d492c6","nonce":"0x0000000000000000","number":"0x8914ec","parentHash":"0x705a0b921245d4e480933e5fd1cab446ded464600b374aaa21bb9d2fbf6dd071","receiptsRoot":"0xc3853474f16acbc611eb5ca71dd8c54ace3100d878363c57a882ae8378955988","sha3Uncles":"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347","size":"0x16b26","stateRoot":"0x26f735fceea3cfb2c72749da246e7f53934a6585f4727e1b0709d5c74995807f","timestamp":"0x645d6e84","totalDifficulty":"0xa4a470","transactions":["0x638e9ead7eaddf7a8ad32f1729f4a6991815f8c04846b92245557370a52cdafc","0x52726e2b57c4a32e29f0ac293207f25d77875595a4ee6b181adfb06146b0fffe","0xe93306de0a0c500013e05c6ffb7c501c6def1045fb8a559796b953c1e466260d","0x4dd95cc5c4fe7aa435643ae51248cee90ded85ad992ac99f8079957806c203d3","0x308553ae908896a3a78cc4bce5e9fa32b8449213a9a8003bdad3e2daa09076b5","0x47364731e2320f460d9272c13c76fd9dce80e91fda3b8ce80fe08a64086d59e3","0xc6f77048dfa354af3f77d69245dc62106af2738d33d4f5f8b468141f897b148f","0xdbad6020b3387db9f0cb1e464bf1ec765526d5fbeed0d780bb70ce5495f72303","0xbde8d289ad2a3d90e5678acef02b3b042b61626be0a39ed639b0a38879d0a8e1","0x884a4f9d6e3af9fd2f5c72b93b903dc1792df52001e12b114dc6bf44e01c4ead","0x662ed8fa609854f586e3f4eafdec3d55f5531499b7a23bd80644e79ed6b2b053","0x69026737fc70002e523e7703ce1e0d89af7390d529d308cb5e08e2c55c3fc1e1","0x542890dad9bea30d477893415eda3d8f3f2a3bf18e709f3f4e24c167d5dd10dc","0xdd33d366802312281f4f872097805e519ae4617733fcd978b22d1f7e1abbb7d9","0x79dfc706d7581c697ebe08d540894daaca00d496b8ba3e6c49bcf800e7a0aa22","0x4b90fc9584f3084f82c75dc676830e87b3669f9773f7611a64562683bcf09f92","0x482a3358d2a18c264e73e1e11036241f50554a78b854b35c6d1adfc2d1d4c218","0x2e8ffa43bfc5a9916f8eb469e343b841fa4bd56ff388b4194e9cf9be9133bc9f","0x5faeaf922157d605c19f8a5a75f449960ded61297a50a7ed0afc887c209bcab1","0x935c2426af0ce34c53d7a9c074b3c6182740c943612315f08269a0cc010055e7","0x04ff942582a2504fb39a6be111f9db97d9827d27fd0c2841cc7961935fd1be6c","0xa46de5b9bbf3848ca4572cc45c4c2d694a9c7f2d45edaea75f492342f0715226","0xad77b0c03769ceeb226f41ab8edc4e202b14b3efc1c83a7e3eb78bc3599c7dbe","0x82bdfff652050b14a56dfc839b7d160114976ccb3da037f3c272d4b1aa101439","0x2ebfffde39cdc03beaf4bccc62c3a08a351fbd1f62303a7aad437ce696794e45","0xea05481bc288c83aa859e3ee29f838ec69e145f5dbd5d9ca5d3c4ae9b281cd80","0xf3fe1622f73fb60d92794266d980bbe9a35abf475a5e25d36a60773a1b9ca09a","0x5b349c397c4a5635a6b3804e375c0682835fbba2e0d705310b1c64d258c49dab","0xc7b07bdd5677c3c346f49bd2d54d65370c34a9dd8c29ea6d4bb1729ab6e13639"],"transactionsRoot":"0x73be4e736e029b9fdcbda4813ad4731eb0b394f37577f150e637a5a40926ca2f","uncles":[],"withdrawals":[{"index":"0x4fd174","validatorIndex":"0x9f40","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1d48af"},{"index":"0x4fd175","validatorIndex":"0x9f41","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e3c54"},{"index":"0x4fd176","validatorIndex":"0x9f42","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1eccb3"},{"index":"0x4fd177","validatorIndex":"0x9f43","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1ed7a0"},{"index":"0x4fd178","validatorIndex":"0x9f44","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e48b5"},{"index":"0x4fd179","validatorIndex":"0x9f45","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1db4e6"},{"index":"0x4fd17a","validatorIndex":"0x9f46","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1a460a7"},{"index":"0x4fd17b","validatorIndex":"0x9f47","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1ee461"},{"index":"0x4fd17c","validatorIndex":"0x9f48","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e3be4"},{"index":"0x4fd17d","validatorIndex":"0x9f49","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e9651"},{"index":"0x4fd17e","validatorIndex":"0x9f4a","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1defd9"},{"index":"0x4fd17f","validatorIndex":"0x9f4b","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1e8c12"},{"index":"0x4fd180","validatorIndex":"0x9f4c","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1dd8c7"},{"index":"0x4fd181","validatorIndex":"0x9f4d","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1ec5c4"},{"index":"0x4fd182","validatorIndex":"0x9f4e","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1df604"},{"index":"0x4fd183","validatorIndex":"0x9f4f","address":"0xf36f155486299ecaff2d4f5160ed5114c1f66000","amount":"0x1ec6f6"}],"withdrawalsRoot":"0x5579318dff536da3ea63a244c27453e29654b9c97a235ca1c00934663fe1f26c"}`,
			},
			xc.TxInfo{
				BlockHash:     "0xd090a9e97e00aa135710a92c827def07e4c8ff2269fd69411c48402e0a6a2a89",
				TxID:          "bca068cf854af49fc6b28ff5405068d51d3cefb870e624d22d046005a22349d0",
				ExplorerURL:   "/tx/0xbca068cf854af49fc6b28ff5405068d51d3cefb870e624d22d046005a22349d0",
				From:          "0x17519Be39A6B67a19468dfbDc1D795c38232c274",
				To:            "0xa0a5C02F0371cCc142ad5AD170C291c86c3E6379",
				BlockIndex:    8983756,
				BlockTime:     1683844272,
				Confirmations: 32,
				Sources: []*xc.TxInfoEndpoint{
					{
						Address:     "0x17519Be39A6B67a19468dfbDc1D795c38232c274",
						Amount:      xc.NewAmountBlockchainFromStr("5321609027609419494"),
						NativeAsset: "ETH",
					},
				},
				Destinations: []*xc.TxInfoEndpoint{
					{
						Address:     "0xa0a5C02F0371cCc142ad5AD170C291c86c3E6379",
						Amount:      xc.NewAmountBlockchainFromStr("5321609027609419494"),
						NativeAsset: "ETH",
					},
				},
				Fee:    xc.NewAmountBlockchainFromStr("89668526728137000"),
				Amount: xc.NewAmountBlockchainFromStr("5321609027609419494"),
			},
			"",
		},
		// Send erc20 normal tx
		{
			"normal_erc20_deposit",
			"0x7fba5ad368aab2490731a31d490e22d905c9b47ac2ca03e41b2021bfb76b423b",
			[]string{
				// eth_getTransactionByHash
				`{"blockHash":"0x03d633a561d2217f8d7ae529ed90f3f4709fd62a5fb1b0ff6f7ce487f2113ba7","blockNumber":"0x891528","from":"0xe8be958f910fb1bb439eafbcfd0475509ab6d43f","gas":"0x8757","gasPrice":"0x59682f0b","maxPriorityFeePerGas":"0x59682f00","maxFeePerGas":"0x59682f0d","hash":"0x7fba5ad368aab2490731a31d490e22d905c9b47ac2ca03e41b2021bfb76b423b","input":"0xa9059cbb0000000000000000000000005d2ebdf613d50dc598a09d8ebdc3f285be6cf8ed000000000000000000000000000000000000000000000000000009184e72a000","nonce":"0x33","to":"0xb4fbf271143f4fbf7b91a5ded31805e42b2208d6","transactionIndex":"0xe","value":"0x0","type":"0x2","accessList":[],"chainId":"0x5","v":"0x0","r":"0xabf9ed0aa2255eda67c71e8fed5ee44b50059d507216221ea81400fa2db82289","s":"0x69e16a358d7a216499825143fdfe71f0c7d31d2a5613c5f0aeb5cdff7f04d39d"}`,
				// eth_getTransactionReceipt
				`{"blockHash":"0x03d633a561d2217f8d7ae529ed90f3f4709fd62a5fb1b0ff6f7ce487f2113ba7","blockNumber":"0x891528","contractAddress":null,"cumulativeGasUsed":"0x2f3b78","effectiveGasPrice":"0x59682f0b","from":"0xe8be958f910fb1bb439eafbcfd0475509ab6d43f","gasUsed":"0x8757","logs":[{"address":"0xb4fbf271143f4fbf7b91a5ded31805e42b2208d6","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000e8be958f910fb1bb439eafbcfd0475509ab6d43f","0x0000000000000000000000005d2ebdf613d50dc598a09d8ebdc3f285be6cf8ed"],"data":"0x000000000000000000000000000000000000000000000000000009184e72a000","blockNumber":"0x891528","transactionHash":"0x7fba5ad368aab2490731a31d490e22d905c9b47ac2ca03e41b2021bfb76b423b","transactionIndex":"0xe","blockHash":"0x03d633a561d2217f8d7ae529ed90f3f4709fd62a5fb1b0ff6f7ce487f2113ba7","logIndex":"0x18","removed":false}],"logsBloom":"0x00000000000000000000000000000000000000000000000000000400000000000000100000000000000000000000000000000000000000000000020000000000000040000400000000000008000000000000400000000000000000000000000000000000000000000000100000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","status":"0x1","to":"0xb4fbf271143f4fbf7b91a5ded31805e42b2208d6","transactionHash":"0x7fba5ad368aab2490731a31d490e22d905c9b47ac2ca03e41b2021bfb76b423b","transactionIndex":"0xe","type":"0x2"}`,
				// eth_getBlockByNumber
				`{"baseFeePerGas":"0xb","difficulty":"0x0","extraData":"0xd883010b06846765746888676f312e32302e33856c696e7578","gasLimit":"0x1c9c380","gasUsed":"0x3edb5d","hash":"0x03d633a561d2217f8d7ae529ed90f3f4709fd62a5fb1b0ff6f7ce487f2113ba7","logsBloom":"0xc00c04400500404c00110000840900841002080000000008810004128011008004221400000000000020000801840084440010144002002000001600002022400882402294400000500000090022120000044040010a204280408100000800010000020002000000904090a52410081000000040000841c808a2581400001000130030e0b000002a00000800000004000000048080100280000901010046008046000004300000004810000228000200200002012040024003020104000200029005462208200008040320410502440004489400000800000103a000080221001030002020200004a00001200000600000000200001002000002080002000000","miner":"0x9427a30991170f917d7b83def6e44d26577871ed","mixHash":"0xbe979c23ebac83783f28bd19bc54156afede8a9881f67ee68e585c617d35fa8c","nonce":"0x0000000000000000","number":"0x891528","parentHash":"0x4c0741acfa16a7544e8384ae6ff8e99fc13f7d4f425d37e9b98d649c205d3a7f","receiptsRoot":"0x1b208b79d2ac75825098ae78411aefb6e2e9a475fad97d8d1a1daa8642bde2cd","sha3Uncles":"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347","size":"0xb581","stateRoot":"0xdffaf71a94e6b64d04bc9b5d18a07f1c38c85038504d8ac898c81249e7826578","timestamp":"0x645d71cc","totalDifficulty":"0xa4a470","transactions":["0x2a02b2fea90d4d2210c2b106bfa09bd3083329285479ea56cbb459d1c1d04a39","0xb12cbda3b2674432ce747a93d6297bb153fe8934c34d49c7c462fe251a805552","0x231c2aa257987ceb68d837e5b6625d9783cec0b6eecedd7f35851096ef3a064e","0xefe67c0b5fde1610393b5e81baaf6be946d40c1a8b5cc35e3e96913bc55a08f4","0xefd5d8f84bad43612d72949db1a031a2e631bdfa31ba4da0b56737ec42c0fc34","0x68a3b34a9c88b646b47f9349ad87093fc7696be1d8607eaba41ae60458ed0b00","0x2a7003970d1352ef5b3f36b8e4567f0f79b12c1221aca6def7541c714bd63275","0xefd4a264368a75f0aadd042f1937623cea77a424b32afe03b40bd71fa0cd3c58","0xc7cf43c1b7382901b229f43137b614c86676710863f477b1b976e76a0965095f","0x0a24277f4c37e23a3eb6b1aa5690dea691b86d21cdd8e9b4a63d43c5bc5f358b","0xc769cfe9366d3cc102971db20ee15d77bf22eaedb720a5ab74e985d730129cfe","0x96cf02bdac52cf94bb32192a6ba717cd54832ba182f9bbe6e2fc08674ec3ae4a","0x8dcb26141ec67dcba395a7d07ff4cf2aa7c6faff9b55f384705b131fef5ea127","0x8915c01b564b7ca7f8c3bc8b20cf7311d94e8570c6bdff196b55bb2751ef70d1","0x7fba5ad368aab2490731a31d490e22d905c9b47ac2ca03e41b2021bfb76b423b","0x79a7dc020d3d6989de12e22f7191f9338a96693288fc4fbeaed1bdae7173f46e","0x5ed535730523c3eb3db632b2d59579004bc01a30cd1a40b4e52b94ca07606902","0xd7ce3cae178416095b0205d987d225519420cd93bbad595670e8794544177db5","0x4233c7fea875b11ba216fb98e65ef3fe53b47ab0d07aef3debfaf7c6a14c9d72","0x76b67bfdf76b4242e3d503bec804feed60fc6edd65d57c0a09beef0102db3b70","0x4b5f4b515f0c7e596b959faa233f76402aa70131b0469032e21fe2160e10e2ca"],"transactionsRoot":"0x70a7dbc37ea27140077f216ce19070150afbfbc1abf758d085c9021b463667de","uncles":[],"withdrawals":[{"index":"0x4fd4ac","validatorIndex":"0x33979","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x19f56d"},{"index":"0x4fd4ad","validatorIndex":"0x3397a","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1ca348"},{"index":"0x4fd4ae","validatorIndex":"0x3397b","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1cc394"},{"index":"0x4fd4af","validatorIndex":"0x3397c","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1a6016"},{"index":"0x4fd4b0","validatorIndex":"0x3397d","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x186780"},{"index":"0x4fd4b1","validatorIndex":"0x3397e","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1c38d5"},{"index":"0x4fd4b2","validatorIndex":"0x3397f","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x34f8fd0"},{"index":"0x4fd4b3","validatorIndex":"0x33980","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1a04eb"},{"index":"0x4fd4b4","validatorIndex":"0x33981","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1a0e4c"},{"index":"0x4fd4b5","validatorIndex":"0x33982","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1d8c4a"},{"index":"0x4fd4b6","validatorIndex":"0x33983","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1cbb62"},{"index":"0x4fd4b7","validatorIndex":"0x33984","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1d1aac"},{"index":"0x4fd4b8","validatorIndex":"0x33985","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1c8852"},{"index":"0x4fd4b9","validatorIndex":"0x33986","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x18c245"},{"index":"0x4fd4ba","validatorIndex":"0x33987","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1c978f"},{"index":"0x4fd4bb","validatorIndex":"0x33988","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1c835c"}],"withdrawalsRoot":"0x19c8289ae378446696ca072ea8bd762ba1ebd465e505e31ed93d89b99b62ae8c"}`,
				// eth_getBlockByNumber
				`{"baseFeePerGas":"0xa","difficulty":"0x0","extraData":"0xd883010b05846765746888676f312e32302e32856c696e7578","gasLimit":"0x1c9c380","gasUsed":"0xe7023b","hash":"0x7041515bf99b52262d4faeb17ba2a5f772ea463c30db9798371ff2094aa75ddc","logsBloom":"0x006408484088f02c801010009515008412eb29040002580c858101128851002004aa84e00080800041110000150401a4485110540020082012001624c124a26100026032947080805802020800801224020d82404007202080518105888b08010010350492478080804004a604102b0000080036000c50c48020125602001040132020621880ad0a20442c44400305264001800102100a880001014914668040660c000638880202101200222518830026000220a04402400702018408a2000390a144a3014020082402204345126444000814000080229030432739098261821810002120628114a854032c1280501001012300000812508106400802100080","miner":"0xc6e2459991bfe27cca6d86722f35da23a1e4cb97","mixHash":"0x522990debf63b7812eb8b6b96e0c56f91d567b8e2109e0a5f77450e7315ca21d","nonce":"0x0000000000000000","number":"0x89153b","parentHash":"0x41957451a5214e3420e12199c702016f2aa6a2d4848d429eefdfccc98661afd9","receiptsRoot":"0x01d943be32594c16c5c7558ca9b0fed2bfbb159e4e607835aeb22a827916f552","sha3Uncles":"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347","size":"0xfb37","stateRoot":"0x0d2abf67da6fd97a434c3d39058eff6acdf45b276e40b387eb32390c576fc413","timestamp":"0x645d72e0","totalDifficulty":"0xa4a470","transactions":["0x1aae2d96b2aee3ecfb01d95c33b32493df758a99b93046ff7dd50172b8cf6d30","0xa498121ad49d5dfc5b46d24b85ea857b426a1ed0cf4133c2cb96561a478d8e08","0xbd4de1c91760f3123402e74a6814fd972fa9a5c03fd18b13ffb7ec7586883425","0xce48fb1ee75beb40acee9bc54dda29e7811a4d3eed1d635ce7ba184979a6d883","0xe532067ac4b74deffca708c1eec3cfe7ba79dbac70518fb752d86941d828e4eb","0x7eb0a23f03525a0830befde8bfa3fa7c1bccef491711356c4880d401b62eb671","0xde51711ca74c63e8d9afdd8152d0a2c0c4f125ba3f6a9126c7d490fdd032c4cf","0xbd6aa59ce286c4221afd9000f834ddc207a93a7bc2a9ae068713ce8a43ee2742","0x746f05148b6ce98fc136d7c4ed00a73cc5c2ea68ab80bd3c5d3bd94402e20cc7","0x32991b9b8a1b1ba7ff7a9763f59e2ea1543acd28d6e2789d328a8317b4f74244","0x5a21a15f8736d513c48ce432ef3640c647f22d2ebb3dba833b0edfc92f27ef1d","0x4ee9cb1837031eb167b1357e8c9c19701ef6295729c2c580f9f7b9dee3b03f7c","0x4d5d016a4067cac522a426f12698d10915546fb65136074eb971cffbb8d6169e","0x68007016d532e43af452ef414a95040259ba86dcc26f380985673601e6692522","0xea0a297b661d014fedfdb2da3268fa1798db565d90ca9596bdf71df8b573df80","0x81058b8e6beef482f6a93e74c8cc5eaec892466465c3094713a950179c1a8785","0x786824ed4919c538506cfa100ee2e96869dca946d9e2be02401a8f7e1f66c6a8","0xdee6f95049d81f0d8375db35e5d0a668d8492032b1448a94b0f7912ec6c2ac64","0x61134262a45b0cdeb52d96e90c97780bc08779af8b086036d61d0657623dda01","0xbe825ab6ca9760557b9fa90e88c0d5f3fc58f5dd197bc2454f27d5e05b482f10","0xd71385e6984b41eafa8ef8e8614ec7c955e0c6c0073b2ae0073d4be11c1f7610","0x5e4ce86d4b6b09ef361f873a8ccb02c6b28f203b54a5a299ff5b3a486a5591e0","0x0ce8a4a79d39c3d8f57eb632deefd3901c23ae9cb9f49fc8811bc815195e7ec1","0xbd5f6f91610afd56a4d80483e38c14b7b479876e6f156828590c75bc09a317f4","0x824a8744c6cc856e49239d0e6547396d8435944bdb8fe89ca868f5a6c31a9c3f","0xf46646fc9e738b4079367c8d950b6037315ecff744b6fefa52afe1943c88a45e","0xb77420a96f2b4be4a4bedac65b41bdd98e5e7541edfa022451cfc927ec46c60f","0x5d4fa90d7fd3fe0571f403149cd88869f9185ce6854a323ed8d454e319f4d80a","0x6dbdd47cdaa9cd3c391c67d6d623e7bbeb3302c09ea7b4770ee0649245dfc80e","0x50e6add79c2895a3f78f748eff4778d52f5e428e2672e23fa38b9347559e451d","0xd0f55fd2c13714ba6aee6cff8851733545ce2a2b1a89723f88d039a0d68f68d8","0xd4965e1587ec7256dbdda89b73d961cd5d4d5623ddbe78bca33eb00de141f236","0x62ccd2c5e3b5bff5be54f95f5f26e70043edb8e3dc875ae4c7aa9ca7bb26f4fa","0xea90ddc11b18a323704f9b488f854e915ed1f85e47a5aa97d92490c3cb104f6b","0x23d2bd4b44bff5517b1302d15fa69195ddd288ec666cf7ac06c091ed415324d0","0xdc6d15f3e70d77a059570e8f797c8bd77bc1a763e03351175dcafe80235c8654","0xfba6bed9ee750c686a7f97fb1639a9eadd746ba47d367221caa9a3d6ca8e76b3","0x382510b2ee498a11dfc79c13ccc881221b5d22ac1079c42ece5a9ca481a83299","0xbee5e61838f19180bf3b2d6a1f5457be9449060a77cf997f9899c2c0abbe8bcb","0xb8772fe626c2a3151e5c2947b51f80519df6cdff0ba34d9b22a148d9e88740b1","0x89a3606507a02b2b879ded73d8a21240dd53f5e8b3a2733458d773de8368022c","0xd87c56af4fdc483cb66935d7b47afcc0f545098a0c689f6baa102ed52debdef2","0x7b49ea42028f098d46b330bd4b15422004cfdab6194de4307d6465fe3842dffb"],"transactionsRoot":"0xd6a76734c1194ba7a54efdf597b6bbd71a7c258df83e17ae24c61ef55ed6f5a6","uncles":[],"withdrawals":[{"index":"0x4fd5dc","validatorIndex":"0x343b9","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1e3737"},{"index":"0x4fd5dd","validatorIndex":"0x343ba","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1e6b61"},{"index":"0x4fd5de","validatorIndex":"0x343bb","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1e609a"},{"index":"0x4fd5df","validatorIndex":"0x343bc","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1e446a"},{"index":"0x4fd5e0","validatorIndex":"0x343bd","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1ec58a"},{"index":"0x4fd5e1","validatorIndex":"0x343be","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1f08f0"},{"index":"0x4fd5e2","validatorIndex":"0x343bf","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1e388e"},{"index":"0x4fd5e3","validatorIndex":"0x343c0","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1de6e9"},{"index":"0x4fd5e4","validatorIndex":"0x343c1","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1d8671"},{"index":"0x4fd5e5","validatorIndex":"0x343c2","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1d921d"},{"index":"0x4fd5e6","validatorIndex":"0x343c3","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1e47be"},{"index":"0x4fd5e7","validatorIndex":"0x343c4","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1e68a0"},{"index":"0x4fd5e8","validatorIndex":"0x343c5","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1d4535"},{"index":"0x4fd5e9","validatorIndex":"0x343c6","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1e9eee"},{"index":"0x4fd5ea","validatorIndex":"0x343c7","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1eb96d"},{"index":"0x4fd5eb","validatorIndex":"0x343c8","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1da634"}],"withdrawalsRoot":"0x5f2d20dfa1ed20da2588eea50327afc1b477e2ad628b8d40c5eaddabbf7d32be"}`,
			},
			xc.TxInfo{
				BlockHash:       "0x03d633a561d2217f8d7ae529ed90f3f4709fd62a5fb1b0ff6f7ce487f2113ba7",
				TxID:            "7fba5ad368aab2490731a31d490e22d905c9b47ac2ca03e41b2021bfb76b423b",
				ExplorerURL:     "/tx/0x7fba5ad368aab2490731a31d490e22d905c9b47ac2ca03e41b2021bfb76b423b",
				From:            "0xE8Be958f910FB1bb439EaFBcFD0475509AB6D43F",
				To:              "0x5D2EBDf613D50Dc598A09d8Ebdc3F285bE6CF8ed",
				BlockIndex:      8983848,
				BlockTime:       1683845580,
				Confirmations:   19,
				ContractAddress: "0xB4FBF271143F4FBf7B91A5ded31805e42b2208d6",
				Sources: []*xc.TxInfoEndpoint{
					{
						Address:         "0xE8Be958f910FB1bb439EaFBcFD0475509AB6D43F",
						Amount:          xc.NewAmountBlockchainFromStr("10000000000000"),
						ContractAddress: "0xB4FBF271143F4FBf7B91A5ded31805e42b2208d6",
						NativeAsset:     "ETH",
					},
				},
				Destinations: []*xc.TxInfoEndpoint{
					{
						Address:         "0x5D2EBDf613D50Dc598A09d8Ebdc3F285bE6CF8ed",
						Amount:          xc.NewAmountBlockchainFromStr("10000000000000"),
						ContractAddress: "0xB4FBF271143F4FBf7B91A5ded31805e42b2208d6",
						NativeAsset:     "ETH",
					},
				},
				Fee:    xc.NewAmountBlockchainFromStr("51970500381117"),
				Amount: xc.NewAmountBlockchainFromStr("10000000000000"),
			},
			"",
		},
		// Parse multi erc20 transfer
		{
			"multi_erc20_deposit",
			"0xb3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f",
			[]string{
				// eth_getTransactionByHash
				`{"blockHash":"0x17d3a092ad1855a468fd1cbfeb03245ab09367272daf2433aa93ebb41e570f2d","blockNumber":"0x89152f","from":"0x489a3aa83c1f204f0647c67c9fbf3e7ee1463bc5","gas":"0x61a80","gasPrice":"0x59682f0c","maxPriorityFeePerGas":"0x59682f00","maxFeePerGas":"0x59682f12","hash":"0xb3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f","input":"0x85ff842c00000000000000000000000000000000000000000000000000000000000000c0000000000000000000000000000080383847bd75f91c168269aa74004877592f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006100000000000000000000000000000000000000000000000000000000000557300000000000000000000000000000000000000000000000000000000000000014489a3aa83c1f204f0647c67c9fbf3e7ee1463bc5000000000000000000000000","nonce":"0x71","to":"0x805fe47d1fe7d86496753bb4b36206953c1ae660","transactionIndex":"0x15","value":"0x6a94d74f430000","type":"0x2","accessList":[],"chainId":"0x5","v":"0x0","r":"0xeddde218c0079cffd7e496bbbcbe31689754af4ce18bb1407d3d9dffee7a87ea","s":"0x48ed7ad3f32c037af91d575c054e48a78d78c21bee76a4148ad5e2f39475ef65"}`,
				// eth_getTransactionReceipt
				`{"blockHash":"0x17d3a092ad1855a468fd1cbfeb03245ab09367272daf2433aa93ebb41e570f2d","blockNumber":"0x89152f","contractAddress":null,"cumulativeGasUsed":"0x28e666","effectiveGasPrice":"0x59682f0c","from":"0x489a3aa83c1f204f0647c67c9fbf3e7ee1463bc5","gasUsed":"0x2862a","logs":[{"address":"0xb4fbf271143f4fbf7b91a5ded31805e42b2208d6","topics":["0xe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c","0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"],"data":"0x000000000000000000000000000000000000000000000000006a94d74f430000","blockNumber":"0x89152f","transactionHash":"0xb3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f","transactionIndex":"0x15","blockHash":"0x17d3a092ad1855a468fd1cbfeb03245ab09367272daf2433aa93ebb41e570f2d","logIndex":"0x1d","removed":false},{"address":"0xb4fbf271143f4fbf7b91a5ded31805e42b2208d6","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d","0x000000000000000000000000b3a16c2b68bbb0111ebd27871a5934b949837d95"],"data":"0x000000000000000000000000000000000000000000000000006a94d74f430000","blockNumber":"0x89152f","transactionHash":"0xb3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f","transactionIndex":"0x15","blockHash":"0x17d3a092ad1855a468fd1cbfeb03245ab09367272daf2433aa93ebb41e570f2d","logIndex":"0x1e","removed":false},{"address":"0xcc7bb2d219a0fc08033e130629c2b854b7ba9195","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000b3a16c2b68bbb0111ebd27871a5934b949837d95","0x000000000000000000000000805fe47d1fe7d86496753bb4b36206953c1ae660"],"data":"0x0000000000000000000000000000000000000000000000002f3935c5c5e2d7ad","blockNumber":"0x89152f","transactionHash":"0xb3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f","transactionIndex":"0x15","blockHash":"0x17d3a092ad1855a468fd1cbfeb03245ab09367272daf2433aa93ebb41e570f2d","logIndex":"0x1f","removed":false},{"address":"0xb3a16c2b68bbb0111ebd27871a5934b949837d95","topics":["0x1c411e9a96e071241c2f21f7726b17ae89e3cab4c78be50e062b03a9fffbbad1"],"data":"0x00000000000000000000000000000000000000000000018791b4f45022da96ed00000000000000000000000000000000000000000000ae03fa18d28e355548ce","blockNumber":"0x89152f","transactionHash":"0xb3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f","transactionIndex":"0x15","blockHash":"0x17d3a092ad1855a468fd1cbfeb03245ab09367272daf2433aa93ebb41e570f2d","logIndex":"0x20","removed":false},{"address":"0xb3a16c2b68bbb0111ebd27871a5934b949837d95","topics":["0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822","0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d","0x000000000000000000000000805fe47d1fe7d86496753bb4b36206953c1ae660"],"data":"0x000000000000000000000000000000000000000000000000006a94d74f430000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002f3935c5c5e2d7ad","blockNumber":"0x89152f","transactionHash":"0xb3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f","transactionIndex":"0x15","blockHash":"0x17d3a092ad1855a468fd1cbfeb03245ab09367272daf2433aa93ebb41e570f2d","logIndex":"0x21","removed":false},{"address":"0xcc7bb2d219a0fc08033e130629c2b854b7ba9195","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x000000000000000000000000805fe47d1fe7d86496753bb4b36206953c1ae660","0x00000000000000000000000000007d0ba516a2ba02d77907d3a1348c1187ae62"],"data":"0x0000000000000000000000000000000000000000000000002f3935c5c5e2d7ad","blockNumber":"0x89152f","transactionHash":"0xb3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f","transactionIndex":"0x15","blockHash":"0x17d3a092ad1855a468fd1cbfeb03245ab09367272daf2433aa93ebb41e570f2d","logIndex":"0x22","removed":false},{"address":"0xcc7bb2d219a0fc08033e130629c2b854b7ba9195","topics":["0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925","0x000000000000000000000000805fe47d1fe7d86496753bb4b36206953c1ae660","0x00000000000000000000000000007d0ba516a2ba02d77907d3a1348c1187ae62"],"data":"0x0000000000000000000000000000000000000000000000000000000000000000","blockNumber":"0x89152f","transactionHash":"0xb3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f","transactionIndex":"0x15","blockHash":"0x17d3a092ad1855a468fd1cbfeb03245ab09367272daf2433aa93ebb41e570f2d","logIndex":"0x23","removed":false},{"address":"0xcc7bb2d219a0fc08033e130629c2b854b7ba9195","topics":["0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef","0x000000000000000000000000805fe47d1fe7d86496753bb4b36206953c1ae660","0x00000000000000000000000000007d0ba516a2ba02d77907d3a1348c1187ae62"],"data":"0x0000000000000000000000000000000000000000000000002f3935c5c5e2d7ad","blockNumber":"0x89152f","transactionHash":"0xb3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f","transactionIndex":"0x15","blockHash":"0x17d3a092ad1855a468fd1cbfeb03245ab09367272daf2433aa93ebb41e570f2d","logIndex":"0x24","removed":false},{"address":"0x00007d0ba516a2ba02d77907d3a1348c1187ae62","topics":["0x7ec1c94701e09b1652f3e1d307e60c4b9ebf99aff8c2079fd1d8c585e031c4e4","0x000000000000000000000000805fe47d1fe7d86496753bb4b36206953c1ae660","0x0000000000000000000000000000000000000000000000000000000000000061"],"data":"0x000000000000000000000000489a3aa83c1f204f0647c67c9fbf3e7ee1463bc500000000000000000000000000000000000000000000000000000000000000c00000000000000000000000000000000000000000000000002f3935c5c5e2d7ad0000000000000000000000000000000000000000000000000000000000055730000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000002800000000000000000000000000000000000000000000000000000000000000014a0b5cbdc4d14c4f4d36483ec0de310919f3b2d90000000000000000000000000000000000000000000000000000000000000000000000000000000000000016065f49bd49de252a7f0d9100776c70f0da398368ef9866f8e21fbb0e3e630e74f000000000000000000000000489a3aa83c1f204f0647c67c9fbf3e7ee1463bc5000000000000000000000000b4fbf271143f4fbf7b91a5ded31805e42b2208d6000000000000000000000000000000000000000000000000006a94d74f4300000000000000000000000000000000000000000000000000000000000000000120000000000000000000000000000080383847bd75f91c168269aa74004877592f0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000014489a3aa83c1f204f0647c67c9fbf3e7ee1463bc5000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000","blockNumber":"0x89152f","transactionHash":"0xb3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f","transactionIndex":"0x15","blockHash":"0x17d3a092ad1855a468fd1cbfeb03245ab09367272daf2433aa93ebb41e570f2d","logIndex":"0x25","removed":false}],"logsBloom":"0x00200000000000000000000080000000000800002000000000010000080000000000000000000200000000000000000000000000000000000000020400200040000000000430000008000008000000200000000000001000000000008080000000000000000000000000000000000000000000000000000000000010000000000000000000000000004000000000000200000001000000080000004010000000020000000000000000000000000000000000000000040000000000000020000000204002000000000000000000000004000000000000001000010000000020000010100000000200000000000000000000001000000000400000000000000001","status":"0x1","to":"0x805fe47d1fe7d86496753bb4b36206953c1ae660","transactionHash":"0xb3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f","transactionIndex":"0x15","type":"0x2"}`,
				// eth_getBlockByNumber
				`{"baseFeePerGas":"0xc","difficulty":"0x0","extraData":"0xd883010b06846765746888676f312e32302e33856c696e7578","gasLimit":"0x1c9c380","gasUsed":"0x40ffac","hash":"0x17d3a092ad1855a468fd1cbfeb03245ab09367272daf2433aa93ebb41e570f2d","logsBloom":"0x802508400400a6882000001e8003a0849018081030000c74010300130800100004a0042052000600104002081144000001011014c008002001800e0c40ac244010064432447000001a08d08a000013280084001000ca38488008902080a80008040c04004a220040814000a40e0008008000c8024048415088215010200010001110a0e01004a00a28400840800000820200860110104288000021401406800876880006780003414000204228000100240002012084220423000194a4e00140102d562304200000840220412540401c21081000008006103081228000022108805010e425680304a08040a02880d000040092000c0022c400024008b0804441","miner":"0xf29ff96aaea6c9a1fba851f74737f3c069d4f1a9","mixHash":"0xdf968dc511b6d20aaa6b6fb1f184fb12721c98dd1b60e7fd0ad05bf6bafaae45","nonce":"0x0000000000000000","number":"0x89152f","parentHash":"0x1d62529b39fb2a9128f0a6974d6884cc83d597b2b28ecceb2481592aeab67c7e","receiptsRoot":"0x91de28df8bdcba2a225a6055a91eb98a3d5077851f72552fd2d01ee300204785","sha3Uncles":"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347","size":"0xbcea","stateRoot":"0xf341dbc3ffa26b025175b0b3ae12486414dd708968a873533f431305d0593ed0","timestamp":"0x645d7238","totalDifficulty":"0xa4a470","transactions":["0x9ddd0ba4a7b6d1e0208f89c3bb8f8fb3c08f62cfb7455d9c653e83e852e1be10","0xc1fbc8d97a9555595aaa2b042349fc80aa2c81a3d25e8c67b99f251ed9c57a8d","0x44ad22b2348477b4e5d4ad7be40b1c9ca9d33c48479f00138e04e1e344b7d8a3","0xe39bb91cd27c4c2cfd4355bb9f1fad043ba90ce9d36e493ad9dbff7f86e7ff3f","0x8baf664193be9f32f4309dfe67843f69ff504466aaa3e0d3b0a88d1d3b0cd566","0xcc1ef220654fa3f8d553c9dead5d3586f5903ccb2dcd5c63a8a0651ff651a706","0xcc2140f71456993f0c693d343c606b0201c7a527d517349cdb398890a7ce881e","0x26765934629a0f4c6eb217ce33277be54c7e89dee19733421eaadc56b49a6881","0xfd4f08359a57750c832fb8bbb3aeb5f65c1a9155114385b5646105ad43825a67","0xb392bfbe5797b65b8e53adef85cb106d674b781b36288e436b6914384a64a42c","0xf0bdde2b3ac7594ab1fe87958322ecde59b51c128d9ab4c21054a3c7311c2140","0x51e8066ef4adc92f82975a83c23f9d7f9ed59fb614767b232267d5a50ae23709","0x7e60de38358ac757a873c07dacb7e82212b70686e8935933b03382bbfecaa8c3","0x4fb4226d7755c74bd9d3e2a3a3b46204c8b2b2ba825875e2f9f57590121d758d","0xe8a60c17e6211ac5529d1c0957da7ace732e78be0baccaa33afb3312c15f25fe","0x71b74a28b9a52dc76461c7c32c0bbf505920d86700cfaa1be93debf02e25275a","0x484577c602a92633b84f0de8c3081136c0c83ba45f72a6c7db13cb5c001812ab","0x59b0b540a35ed6af08f7413da0c1e25f054c51feff830f44b25699e3e1f6ee38","0x5758a506e2701e95db58ad7e1465afd6a25358fc1d9acac1f93a060de5af7fa1","0x10db0e3f366adaa72d1c43a506aaa17ef2e32cd390badd6258f52798093d1c3b","0x69e4050d3f0f6d2c71f11d2d065705eec9364b7330d4ba7acceef35a7d10c6c8","0xb3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f","0xf18ac7d92debbd65ef45f676d427dc3699ab01f2a1d7eaf17f307a39dc9e7538","0xff1f43c3f9b8a3a7666ac23407628324169f7049e7a0043c37eea060d2048f58","0x44b34923c696bbf4bb8574d3581f3ae0de3728d8780a776929a7fec1373ef392","0x8712e80897ea4072ccc629ebf237868a911ac82056eb773030e74d3775c95a65","0x956fe598a2d87a7106c9aba97690b833bd39bca4d6468232fd277875524447e9","0x8b8ef48393e6cb80ae1ca0e09db9c3737b14a3f7a2cd40b21426f3b6448b5b80","0x7ed440bbcbacaa90f0bf6ca79aaa9d5e59f11f4a0c362d5f18537cf9ffc64074","0xafc4c18df696a09354aba0a23dad2204cf315d5603b73f2006068939a8428353","0xa1fc74af0bb980bcf94177992bbcb233aa8a56c133033e5203498098d69ed6f4","0xb881c161c4958fa5b0a07ed2028f0cf3f2e6647f2a8e85c31c8a4b3da4dc4762"],"transactionsRoot":"0x73b351a7e242b5dac0ae463cc9a6c6d4330bce6210ac9eed84c0149d4d5a0117","uncles":[],"withdrawals":[{"index":"0x4fd51c","validatorIndex":"0x339ec","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1ad1e2"},{"index":"0x4fd51d","validatorIndex":"0x339ed","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1e2de7"},{"index":"0x4fd51e","validatorIndex":"0x339ee","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1cff10"},{"index":"0x4fd51f","validatorIndex":"0x339ef","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x198edc"},{"index":"0x4fd520","validatorIndex":"0x339f0","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1ba6e9"},{"index":"0x4fd521","validatorIndex":"0x339f1","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1c2ad7"},{"index":"0x4fd522","validatorIndex":"0x339f2","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1afacd"},{"index":"0x4fd523","validatorIndex":"0x339f3","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1c9b7e"},{"index":"0x4fd524","validatorIndex":"0x339f4","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1ca79d"},{"index":"0x4fd525","validatorIndex":"0x339f5","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1b604c"},{"index":"0x4fd526","validatorIndex":"0x339f6","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1d772b"},{"index":"0x4fd527","validatorIndex":"0x339f7","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x19a5ef"},{"index":"0x4fd528","validatorIndex":"0x339f8","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1cdc1f"},{"index":"0x4fd529","validatorIndex":"0x339f9","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1d7e64"},{"index":"0x4fd52a","validatorIndex":"0x339fa","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x1c654d"},{"index":"0x4fd52b","validatorIndex":"0x339fb","address":"0x85bc9b9da65694345f2a360e46c7abeed8df895b","amount":"0x19dda1"}],"withdrawalsRoot":"0x43220e00b40d79d4bf5efc17d53128232254ed9e0be21df6947123feb5b2c733"}`,
				// eth_getBlockByNumber
				`{"baseFeePerGas":"0xb","difficulty":"0x0","extraData":"0x4e65746865726d696e64","gasLimit":"0x1c9c380","gasUsed":"0x411183","hash":"0xfab7fb7e5d36366c47ae086992949daf4f1ff56488b0da8003591c162e54ccb0","logsBloom":"0x8000120080284004000020030195024400030100004110080008000008000000034880010080820000020108000000400000100400000020020404100160800020004000988000000000000a000810060225004000800080004841004008000001002104020480400000000000500f8100014000002043810000401c00000008002a000008001000a0000924020a041000050010000002000000000100400410020400041100040800001000144082100441428680c801424002000601020020809000020100000085026000000000000000d00040000080100900110100240208900801246000102034020d02c4003082010110001902848002000001010440","miner":"0x000095e79eac4d76aab57cb2c1f091d553b36ca0","mixHash":"0x79788fc0b75dcc9523901ae5aa44a6bce981cc88a03006998fdd686e0c497f32","nonce":"0x0000000000000000","number":"0x89155e","parentHash":"0xb54b4ee55f85cbad2545bcd2e65949d8c9141849a3c8e63a3ecfdf47a15ac11a","receiptsRoot":"0xba2c9155ca1d0c30b8df13f7edb42da9f5d0982eeadf449c68eff01bdaf608b0","sha3Uncles":"0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347","size":"0xbb5b","stateRoot":"0x7d3e4185f85f2dedc56263238cf0c6b1f20c190a913f7a0d313017c605c381ac","timestamp":"0x645d74f0","totalDifficulty":"0xa4a470","transactions":["0xd1f8c9dc13e95674313b1a68d6886c4af50b0db585e51fbccfc542039b2906c1","0x6eef6929d592942fc33f320fc1eeab297374823ee4288e85647c4a7272dfcd30","0x062899dbee1eadb3e04750e3d634605da9f3810a36c9506b96f8581fd46782f3","0x7d60969bee5d67c811d5e3be122fee29b29502691f26dfdf2ee0ad066cebfc16","0x5fa5fe97b5df6d1b4228b5440d72d19591e6a6fef0cc4f5149f2662a777fc072","0x326c0541499679643dfe5d1e68418e8f1ac1638141edbd1ea9aa81466893b064","0xc22781323752fbf5db6650b5111f3d32e5d935a9fd395ed677191f1ded0996a2","0x23daed3af731f2c1783956fbfefef441541d39e9fcc3f5fd03f769423f8e07dd","0x8c549220b3a0c1de2be998412ff96562e5a4d0e7c4916d59f2d58cdfbbe15c9a","0xaf72951e96959ebd188e012eb4097180c0c3aef0a4e01ccff895a02bbc9f467d","0xc49ff950234d88cba3f26ff19ea19a73e4d3dc5d29d2f194249f1b1dfff51a64","0x4d6a46d288144b179f34e812d32770dd7771f7aa9981d8eb710eff806d82cf07","0x4e52ff96e4a1b3a402b4cc204bc744a6bf0cfb899f9ec9d954d9c9a6b299ba85","0xeda7afa61cbae6af5d59a37939fdb3c45c19e90c5dbb1763c0615a4434ea12a1","0x7536b273e1d95f89776a7e554bfeb7e31829abe1b744ae9500945810d5786d4b","0xb3300adbb2dff7f02e5d95e9f6d2d382d8751a4d508eff96c5cae876e0a7c525","0x6c69ada417dd8f85ce552a65284a8df0f01ca47c1f4f11e23ea160e4b59177a4","0x8a209655a148cedd506fd293820f7e81f044a77e54c534d4cc5a8f47c294b6d5","0xdc4ba5332200de1bde9be4077ddd14534748cc5f08099198c4ec265b9902f505","0xe0929869936568afd6a855af710392f2b31b5c6ceddbbb2d27efb53cac13dc55","0x6a3aa8a16fd622ca47d3ff684737acbda22d5d984c9d0a60d533b7c077f5b4d6","0x9623aded68f1a26022e873d0407e5cd436e6e21540733794db1ae8a906e73946","0xd479b0dd8f09e13cb1c05cf7f558a025ef7cf0a4b9af6e59c092b5288ee56b53","0xab9da6e93e805971b7ed4048e1931f2a9a83711792f62c3cdcff9acf98ffbbbb","0x658042508ec734452144a452c049403df152e84267ee5119fcf5d32e1f552c45","0x774e2df2c49b185bace3af75cb788ec162ebc4976f319d54b19832428045748d"],"transactionsRoot":"0xe8cd884359b2604683ff552a25dcd20a6d44a8eb11f5a23f32760160fafe0cd3","uncles":[],"withdrawals":[{"index":"0x4fd80c","validatorIndex":"0x345e9","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1ec58e"},{"index":"0x4fd80d","validatorIndex":"0x345ea","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1f03e2"},{"index":"0x4fd80e","validatorIndex":"0x345eb","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1d9006"},{"index":"0x4fd80f","validatorIndex":"0x345ec","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1edc15"},{"index":"0x4fd810","validatorIndex":"0x345ed","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1ec0d3"},{"index":"0x4fd811","validatorIndex":"0x345ee","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1dfa69"},{"index":"0x4fd812","validatorIndex":"0x345ef","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1f1c2d"},{"index":"0x4fd813","validatorIndex":"0x345f0","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1dece2"},{"index":"0x4fd814","validatorIndex":"0x345f1","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1d6d25"},{"index":"0x4fd815","validatorIndex":"0x345f2","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1eb680"},{"index":"0x4fd816","validatorIndex":"0x345f3","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1f2c57"},{"index":"0x4fd817","validatorIndex":"0x345f4","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1d92b0"},{"index":"0x4fd818","validatorIndex":"0x345f5","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1e1b8e"},{"index":"0x4fd819","validatorIndex":"0x345f6","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1e480d"},{"index":"0x4fd81a","validatorIndex":"0x345f7","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1f37d6"},{"index":"0x4fd81b","validatorIndex":"0x345f8","address":"0x9427a30991170f917d7b83def6e44d26577871ed","amount":"0x1e3d26"}],"withdrawalsRoot":"0xd35e7c907fbcafc91dfef93f1db5e612de63a16e3d60484e61c708420415bff2"}`,
			},
			xc.TxInfo{
				BlockHash:   "0x17d3a092ad1855a468fd1cbfeb03245ab09367272daf2433aa93ebb41e570f2d",
				TxID:        "b3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f",
				ExplorerURL: "/tx/0xb3dcb32a7bb4856845898033522c676c1d2d50e0b07e5ec36880cd2d8b2a6b0f",
				From:        "0x489A3AA83C1F204f0647C67C9FBF3e7Ee1463Bc5",
				// to is now the contract address of contract making multiple transfers
				To:              "0x805fE47D1FE7d86496753bB4B36206953c1ae660",
				BlockIndex:      8983855,
				BlockTime:       1683845688,
				Confirmations:   47,
				ContractAddress: "0x805fE47D1FE7d86496753bB4B36206953c1ae660",
				Sources: []*xc.TxInfoEndpoint{
					{
						Address:         "0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D",
						Amount:          xc.NewAmountBlockchainFromStr("30000000000000000"),
						ContractAddress: "0xB4FBF271143F4FBf7B91A5ded31805e42b2208d6",
						NativeAsset:     "ETH",
					},
					{
						Address:         "0xb3A16C2B68BBB0111EbD27871a5934b949837D95",
						Amount:          xc.NewAmountBlockchainFromStr("3402810116999927725"),
						ContractAddress: "0xCc7bb2D219A0FC08033E130629C2B854b7bA9195",
						NativeAsset:     "ETH",
					},
					{
						Address:         "0x805fE47D1FE7d86496753bB4B36206953c1ae660",
						Amount:          xc.NewAmountBlockchainFromStr("3402810116999927725"),
						ContractAddress: "0xCc7bb2D219A0FC08033E130629C2B854b7bA9195",
						NativeAsset:     "ETH",
					},
				},
				Destinations: []*xc.TxInfoEndpoint{
					{
						Address:         "0xb3A16C2B68BBB0111EbD27871a5934b949837D95",
						Amount:          xc.NewAmountBlockchainFromStr("30000000000000000"),
						ContractAddress: "0xB4FBF271143F4FBf7B91A5ded31805e42b2208d6",
						NativeAsset:     "ETH",
					},
					{
						Address:         "0x805fE47D1FE7d86496753bB4B36206953c1ae660",
						Amount:          xc.NewAmountBlockchainFromStr("3402810116999927725"),
						ContractAddress: "0xCc7bb2D219A0FC08033E130629C2B854b7bA9195",
						NativeAsset:     "ETH",
					},
					{
						Address:         "0x00007d0BA516a2bA02D77907d3a1348C1187Ae62",
						Amount:          xc.NewAmountBlockchainFromStr("3402810116999927725"),
						ContractAddress: "0xCc7bb2D219A0FC08033E130629C2B854b7bA9195",
						NativeAsset:     "ETH",
					},
				},
				Fee: xc.NewAmountBlockchainFromStr("248127001985016"),
				// amount is the first destination
				Amount: xc.NewAmountBlockchainFromStr("30000000000000000"),
			},
			"",
		},
	}

	for _, v := range vectors {
		fmt.Println("testing ", v.name)
		server, close := test.MockJSONRPC(&s.Suite, v.resp)
		defer close()
		asset := &xc.AssetConfig{NativeAsset: xc.ETH, Net: "testnet", URL: server.URL, ChainID: 5}

		asset.URL = server.URL
		client, _ := NewClient(asset)
		txInfo, err := client.FetchTxInfo(s.Ctx, xc.TxHash(v.txHash))

		if v.err != "" {
			require.Equal(xc.TxInfo{}, txInfo)
			require.ErrorContains(err, v.err)
		} else {
			require.Nil(err)
			require.NotNil(txInfo)
			require.Equal(v.val, txInfo)
		}
	}
}
